# TouchDesigner 模拟器

这是一个用于模拟TouchDesigner向ESP32发送控制命令的Python应用程序。该应用程序通过串口与ESP32通信，发送命令控制CAN总线上的设备显示不同的情绪状态和LED效果。

## 功能特点

- 通过串口与ESP32通信
- 支持发送情绪控制命令（开心、伤心、惊讶）
- 支持控制LED开关
- 支持发送自定义命令
- 实时显示收发数据的控制台
- 自动检测可用串口
- 跨平台支持（Windows、macOS、Linux）

## 安装要求

1. Python 3.6或更高版本
2. PySerial库
3. Tkinter（Python标准库通常已包含）

## 安装方法

1. 确保已安装Python 3.6+
2. 安装依赖库：

```bash
pip install -r requirements.txt
```

## 使用方法

1. 连接ESP32到计算机
2. 运行程序：

```bash
python td_simulator.py
```

3. 在串口设置区域选择正确的串口和波特率（默认115200）
4. 点击"连接"按钮建立连接
5. 使用情绪控制和LED控制按钮发送命令，或使用自定义命令区域发送特定命令

## 支持的命令

- `EMOTION:1` - 开心状态（彩虹效果）
- `EMOTION:2` - 伤心状态（蓝色闪电）
- `EMOTION:3` - 惊讶状态（紫色追逐）
- `LED:1` - 打开LED
- `LED:0` - 关闭LED

## 与ESP32通信

ESP32主机应当运行相应的固件，能够接收并解析这些命令，然后通过CAN总线将控制信号发送给从机节点。从机节点负责根据收到的命令控制WS2812灯带显示不同的效果。

## 常见问题

1. **找不到串口**：确保ESP32已正确连接，并且驱动程序已正确安装。
2. **连接错误**：可能是串口被其他程序占用，尝试关闭其他可能使用该串口的程序。
3. **命令无响应**：确认ESP32上运行的固件支持相应的命令格式。

## 开发指南

如需扩展功能，可以在`process_touchdesigner_command`方法中添加新的命令处理逻辑，并相应地更新界面。 